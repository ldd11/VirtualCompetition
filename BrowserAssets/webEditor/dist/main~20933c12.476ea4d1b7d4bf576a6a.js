(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{142:function(t,e,n){var i=n(683);i.enable(),t.exports=i("scratch-audioengine")},182:function(t,e,n){"use strict";var i={PLAY:"play",STOP:"stop",STOP_PART_FINISH:"stop_part_finish",LOOP_END:"loopEnd",SAVE_PROJECT:"save_project"},r=n(3),o=n(821),a=new(function(){function t(){var t=this;this.audioEngine=new o,this.actor=null,this.tempo=60,r.a.on(i.PLAY,function(){t.tempo=60})}var e=t.prototype;return e.setEditingTarget=function(t){this.actor=t},e.getEditingTarget=function(){return this.actor},e.getTargetForStage=function(){return{tempo:this.tempo}},e.setStageTempo=function(t){this.tempo=t},e.getStageTempo=function(){return this.tempo},e.changeStageTempo=function(t){this.tempo+=t},t}());e.a=a},227:function(t,e){function n(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(r=i.key,void 0,"symbol"==typeof(o=function(t,e){if("object"!=typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"))?o:String(o)),i)}var r,o}var i=function(){function t(t,e,n){this.audioEngine=t,this.audioPlayer=e,this.lastEffect=n,this.value=this.DEFAULT_VALUE,this.initialized=!1,this.inputNode=null,this.outputNode=null,this.target=null}var e,i,r,o=t.prototype;return o.getInputNode=function(){return this._isPatch?this.inputNode:this.target.getInputNode()},o.initialize=function(){throw new Error(this.constructor.name+".initialize is not implemented.")},o._set=function(){throw new Error(this.constructor.name+"._set is not implemented.")},o.set=function(t){this.initialized||this.initialize();var e=this._isPatch;e&&(this._lastPatch=this.audioEngine.currentTime),this._set(t),this._isPatch!==e&&null!==this.target&&this.connect(this.target)},o.update=function(){},o.clear=function(){this.set(this.DEFAULT_VALUE)},o.connect=function(t){var e=this;if(null===t)throw new Error("target may not be null");if(function t(n){if(n)return n===e||t(n.target)}(t))throw new Error("Effect cannot connect to itself");this.target=t,null!==this.outputNode&&this.outputNode.disconnect(),(this._isPatch||this._lastPatch+this.audioEngine.DECAY_DURATION<this.audioEngine.currentTime)&&this.outputNode.connect(t.getInputNode()),null===this.lastEffect?null!==this.audioPlayer&&this.audioPlayer.connect(this):this.lastEffect.connect(this)},o.dispose=function(){this.inputNode=null,this.outputNode=null,this.target=null,this.initialized=!1},e=t,(i=[{key:"name",get:function(){throw new Error(this.constructor.name+".name is not implemented")}},{key:"DEFAULT_VALUE",get:function(){return 0}},{key:"_isPatch",get:function(){return this.initialized&&(this.value!==this.DEFAULT_VALUE||null===this.audioPlayer)}}])&&n(e.prototype,i),r&&n(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();t.exports=i},230:function(t,e,n){"use strict";var i=n(12),r=n.n(i),o=function(){function t(){}return t.simple=function(t){return JSON.parse(JSON.stringify(t))},t}();function a(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(r=i.key,void 0,"symbol"==typeof(o=function(t,e){if("object"!=typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"))?o:String(o)),i)}var r,o}var u=function(){function t(){}var e,n,i;return t.decimalToHex=function(t){t<0&&(t+=16777216);var e=Number(t).toString(16);return e="#"+"000000".substr(0,6-e.length)+e},t.decimalToRgb=function(t){var e=t>>24&255;return{r:t>>16&255,g:t>>8&255,b:255&t,a:e>0?e:255}},t.hexToRgb=function(t){t=t.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(t,e,n,i){return e+e+n+n+i+i});var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null},t.rgbToHex=function(e){return t.decimalToHex(t.rgbToDecimal(e))},t.rgbToDecimal=function(t){return(t.r<<16)+(t.g<<8)+t.b},t.hexToDecimal=function(e){return t.rgbToDecimal(t.hexToRgb(e))},t.hsvToRgb=function(t){var e=t.h%360;e<0&&(e+=360);var n,i,r,o=Math.max(0,Math.min(t.s,1)),a=Math.max(0,Math.min(t.v,1)),u=Math.floor(e/60),s=e/60-u,c=a*(1-o),l=a*(1-o*s),f=a*(1-o*(1-s));switch(u){default:case 0:n=a,i=f,r=c;break;case 1:n=l,i=a,r=c;break;case 2:n=c,i=a,r=f;break;case 3:n=c,i=l,r=a;break;case 4:n=f,i=c,r=a;break;case 5:n=a,i=c,r=l}return{r:Math.floor(255*n),g:Math.floor(255*i),b:Math.floor(255*r)}},t.rgbToHsv=function(t){var e=t.r/255,n=t.g/255,i=t.b/255,r=Math.min(Math.min(e,n),i),o=Math.max(Math.max(e,n),i),a=0,u=0;r!==o&&(a=60*((e===r?3:n===r?5:1)-(e===r?n-i:n===r?i-e:e-n)/(o-r))%360,u=(o-r)/o);return{h:a,s:u,v:o}},t.mixRgb=function(t,e,n){if(n<=0)return t;if(n>=1)return e;var i=1-n;return{r:i*t.r+n*e.r,g:i*t.g+n*e.g,b:i*t.b+n*e.b}},e=t,i=[{key:"RGB_BLACK",get:function(){return{r:0,g:0,b:0}}},{key:"RGB_WHITE",get:function(){return{r:255,g:255,b:255}}}],(n=null)&&a(e.prototype,n),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),t}();function s(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(r=i.key,void 0,"symbol"==typeof(o=function(t,e){if("object"!=typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"))?o:String(o)),i)}var r,o}var c=Number.isNaN||isNaN,l=function(){function t(){}var e,n,i;return t.toNumber=function(t){if("number"==typeof t)return c(t)?0:t;var e=Number(t);return c(e)?0:e},t.toBoolean=function(t){return"boolean"==typeof t?t:"string"==typeof t?""!==t&&"0"!==t&&"false"!==t.toLowerCase():Boolean(t)},t.toString=function(t){return String(t)},t.toRgbColorList=function(e){var n=t.toRgbColorObject(e);return[n.r,n.g,n.b]},t.toRgbColorObject=function(e){return"string"==typeof e&&"#"===e.substring(0,1)?u.hexToRgb(e):u.decimalToRgb(t.toNumber(e))},t.isWhiteSpace=function(t){return null===t||"string"==typeof t&&0===t.trim().length},t.compare=function(e,n){var i=Number(e),r=Number(n);if(0===i&&t.isWhiteSpace(e)?i=NaN:0===r&&t.isWhiteSpace(n)&&(r=NaN),isNaN(i)||isNaN(r)){var o=String(e).toLowerCase(),a=String(n).toLowerCase();return o<a?-1:o>a?1:0}return i===1/0&&r===1/0||i===-1/0&&r===-1/0?0:i-r},t.isInt=function(t){return"number"==typeof t?!!isNaN(t)||t===parseInt(t,10):"boolean"==typeof t||"string"==typeof t&&t.indexOf(".")<0},t.toListIndex=function(e,n){if("number"!=typeof e){if("all"===e)return t.LIST_ALL;if("last"===e)return n>0?n:t.LIST_INVALID;if("random"===e||"any"===e)return n>0?1+Math.floor(Math.random()*n):t.LIST_INVALID}return(e=Math.floor(t.toNumber(e)))<1||e>n?t.LIST_INVALID:e},e=t,i=[{key:"LIST_INVALID",get:function(){return"INVALID"}},{key:"LIST_ALL",get:function(){return"ALL"}}],(n=null)&&s(e.prototype,n),i&&s(e,i),Object.defineProperty(e,"prototype",{writable:!1}),t}(),f=function(){function t(){}return t.degToRad=function(t){return t*Math.PI/180},t.radToDeg=function(t){return 180*t/Math.PI},t.clamp=function(t,e,n){return Math.min(Math.max(t,e),n)},t.wrapClamp=function(t,e,n){var i=n-e+1;return t-Math.floor((t-e)/i)*i},t.tan=function(t){switch(t%=360){case-270:case 90:return 1/0;case-90:case 270:return-1/0;default:return parseFloat(Math.tan(Math.PI*t/180).toFixed(10))}},t.reducedSortOrdering=function(t){var e=t.slice(0).sort(function(t,e){return t-e});return t.map(function(t){return e.indexOf(t)})},t.scale=function(t,e,n,i,r){return(t-e)/(n-e)*(r-i)+i},t}(),d=n(368),h=n(182);function m(){m=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",a=r.asyncIterator||"@@asyncIterator",u=r.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,n){return t[e]=n}}function c(t,e,n,r){var o=e&&e.prototype instanceof d?e:d,a=Object.create(o.prototype),u=new w(r||[]);return i(a,"_invoke",{value:function(t,e,n){var i="suspendedStart";return function(r,o){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===r)throw o;return k()}for(n.method=r,n.arg=o;;){var a=n.delegate;if(a){var u=N(a,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===i)throw i="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i="executing";var s=l(t,e,n);if("normal"===s.type){if(i=n.done?"completed":"suspendedYield",s.arg===f)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(i="completed",n.method="throw",n.arg=s.arg)}}}(t,n,u)}),a}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var f={};function d(){}function h(){}function p(){}var y={};s(y,o,function(){return this});var g=Object.getPrototypeOf,v=g&&g(g(P([])));v&&v!==e&&n.call(v,o)&&(y=v);var b=p.prototype=d.prototype=Object.create(y);function _(t){["next","throw","return"].forEach(function(e){s(t,e,function(t){return this._invoke(e,t)})})}function E(t,e){var r;i(this,"_invoke",{value:function(i,o){function a(){return new e(function(r,a){!function i(r,o,a,u){var s=l(t[r],t,o);if("throw"!==s.type){var c=s.arg,f=c.value;return f&&"object"==typeof f&&n.call(f,"__await")?e.resolve(f.__await).then(function(t){i("next",t,a,u)},function(t){i("throw",t,a,u)}):e.resolve(f).then(function(t){c.value=t,a(c)},function(t){return i("throw",t,a,u)})}u(s.arg)}(i,o,r,a)})}return r=r?r.then(a,a):a()}})}function N(t,e){var n=e.method,i=t.iterator[n];if(void 0===i)return e.delegate=null,"throw"===n&&t.iterator.return&&(e.method="return",e.arg=void 0,N(t,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var r=l(i,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,f;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function w(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function P(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,r=function e(){for(;++i<t.length;)if(n.call(t,i))return e.value=t[i],e.done=!1,e;return e.value=void 0,e.done=!0,e};return r.next=r}}return{next:k}}function k(){return{value:void 0,done:!0}}return h.prototype=p,i(b,"constructor",{value:p,configurable:!0}),i(p,"constructor",{value:h,configurable:!0}),h.displayName=s(p,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===h||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,s(t,u,"GeneratorFunction")),t.prototype=Object.create(b),t},t.awrap=function(t){return{__await:t}},_(E.prototype),s(E.prototype,a,function(){return this}),t.AsyncIterator=E,t.async=function(e,n,i,r,o){void 0===o&&(o=Promise);var a=new E(c(e,n,i,r),o);return t.isGeneratorFunction(n)?a:a.next().then(function(t){return t.done?t.value:a.next()})},_(b),s(b,u,"Generator"),s(b,o,function(){return this}),s(b,"toString",function(){return"[object Generator]"}),t.keys=function(t){var e=Object(t),n=[];for(var i in e)n.push(i);return n.reverse(),function t(){for(;n.length;){var i=n.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},t.values=P,w.prototype={constructor:w,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function i(n,i){return a.type="throw",a.arg=t,e.next=n,i&&(e.method="next",e.arg=void 0),!!i}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],a=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var u=n.call(o,"catchLoc"),s=n.call(o,"finallyLoc");if(u&&s){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i];if(r.tryLoc<=this.prev&&n.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,f):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;T(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:P(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),f}},t}function p(t,e,n,i,r,o,a){try{var u=t[o](a),s=u.value}catch(t){return void n(t)}u.done?e(s):Promise.resolve(s).then(i,r)}function y(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(r=i.key,void 0,"symbol"==typeof(o=function(t,e){if("object"!=typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"))?o:String(o)),i)}var r,o}var g,v={},b=null;try{b=Promise.all([n.e(14),n.e(20),n.e(18),n.e(19),n.e(13),n.e(15),n.e(21),n.e(10),n.e(12),n.e(16),n.e(17),n.e(11)]).then(n.t.bind(null,962,7)).then(function(t){v=t,g=!0})}catch(t){}var _=function(){function t(){this.runtime=h.a,this._concurrencyCounter=0,this._drumPlayers=[],this._instrumentPlayerArrays=[],this._instrumentPlayerNoteArrays=[],this._bufferSources=[],this._loadAllSounds(),this._playNoteForPicker=this._playNoteForPicker.bind(this),document.addEventListener("music_play_note",this._playNoteForPicker.bind(this)),this.playDrumForBeats=this.playDrumForBeats.bind(this),this.playNoteForBeats=this.playNoteForBeats.bind(this),this.restForBeats=this.restForBeats.bind(this),this._checkStackTimer=this._checkStackTimer.bind(this)}var e,n,i,a=t.prototype;return a._loadAllSounds=function(){var t=this,e=[];this.DRUM_INFO.forEach(function(n,i){var r="drums/"+n.fileName,o=t._storeSound(r,i,t._drumPlayers);e.push(o)}),this.INSTRUMENT_INFO.forEach(function(n,i){t._instrumentPlayerArrays[i]=[],t._instrumentPlayerNoteArrays[i]=[],n.samples.forEach(function(r,o){var a="instruments/"+n.dirName+"/"+r,u=t._storeSound(a,o,t._instrumentPlayerArrays[i]);e.push(u)})}),Promise.all(e).then(function(){console.log("music resource is loaded")}).catch(function(t){console.error("music resource load error")})},a._storeSound=function(){var t,e=(t=m().mark(function t(e,n,i){var r,o,a;return m().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e+".mp3",g){t.next=4;break}return t.next=4,b;case 4:if(v[r]){t.next=6;break}return t.abrupt("return");case 6:return o=v[r],t.next=9,this._decodeSound(o);case 9:a=t.sent,i[n]=a;case 11:case"end":return t.stop()}},t,this)}),function(){var e=this,n=arguments;return new Promise(function(i,r){var o=t.apply(e,n);function a(t){p(o,i,r,a,u,"next",t)}function u(t){p(o,i,r,a,u,"throw",t)}a(void 0)})});return function(t,n,i){return e.apply(this,arguments)}}(),a._decodeSound=function(t){var e=this.runtime.audioEngine;return e?e.decodeSoundPlayer({data:{buffer:t}}):Promise.reject(new Error("No Audio Context Detected"))},a._buildMenu=function(t){return t.map(function(t,e){var n={};return n.text=t.name,n.value=String(e+1),n})},a._getMusicState=function(e){var n=e.getCustomState(t.STATE_KEY);return n||(n=o.simple(t.DEFAULT_MUSIC_STATE),e.setCustomState(t.STATE_KEY,n)),n},a._onTargetCreated=function(e,n){if(n){var i=n.getCustomState(t.STATE_KEY);i&&e.setCustomState(t.STATE_KEY,o.simple(i))}},a.playDrumForBeats=function(t,e){return this._playDrumForBeats(t.DRUM,t.BEATS,e)},a.midiPlayDrumForBeats=function(t,e){var n=l.toNumber(t.DRUM);n=Math.round(n);var i=this.MIDI_DRUMS[n-35];n=i?i[0]:2,n+=1,this._playDrumForBeats(n,t.BEATS,e)},a._playDrumForBeats=function(t,e,n){return this._stackTimerNeedsInit(n)?(t=l.toNumber(t),t=Math.round(t),t-=1,t=f.wrapClamp(t,0,this.DRUM_INFO.length-1),e=l.toNumber(e),0===(e=this._clampBeats(e))||0===this.getTempo()?0:(this._playDrumNum(n,t),n.stackFrame.timer=null,this._beatsToSec(e))):(console.error("_playDrumForBeats error!"),0)},a._playDrumNum=function(e,n){var i=this;if(null!==e.runtime.audioEngine&&null!==e.target.sprite.soundBank&&!(this._concurrencyCounter>t.CONCURRENCY_LIMIT)){var r=this._drumPlayers[n];if(void 0!==r){r.isPlaying&&!r.isStarting&&r.take();var o=e.runtime.audioEngine,a=o.audioContext.createGain();a.connect(o.getInputNode()),this._concurrencyCounter++,r.once("stop",function(){i._concurrencyCounter--}),r.play(),r.connect({getInputNode:function(){return a}})}}},a.restForBeats=function(t,e){if(this._stackTimerNeedsInit(e)){var n=l.toNumber(t.BEATS);n=this._clampBeats(n);var i=this._beatsToSec(n);return e.stackFrame.timer=null,i}},a.playNoteForBeats=function(e,n){if(this._stackTimerNeedsInit(n)){var i=l.toNumber(e.NOTE);i=f.clamp(i,t.MIDI_NOTE_RANGE.min,t.MIDI_NOTE_RANGE.max);var r=l.toNumber(e.BEATS);if(0===(r=this._clampBeats(r))||0===this.getTempo())return 0;var o=this._beatsToSec(r);return this._playNote(n,i,o),n.stackFrame.timer=null,o}return console.error("playNoteForBeats error!"),0},a._playNoteForPicker=function(t){var e=(t||{}).detail;if(e&&"music"===e.category){var n={runtime:this.runtime,target:this.runtime.getEditingTarget()};this._playNote(n,e.noteNum,.25)}},a._playNote=function(e,n,i){var r=this;if(null!==e.runtime.audioEngine&&!(this._concurrencyCounter>t.CONCURRENCY_LIMIT)){var o=this._getMusicState(e.target).currentInstrument;o||(o=t.DEFAULT_MUSIC_STATE.currentInstrument);var a=this.INSTRUMENT_INFO[o].samples,u=this._selectSampleIndexForNote(n,a);if(void 0!==this._instrumentPlayerArrays[o]&&void 0!==this._instrumentPlayerArrays[o][u]){var s=e.runtime.audioEngine;this._instrumentPlayerNoteArrays[o][n]||(this._instrumentPlayerNoteArrays[o][n]=this._instrumentPlayerArrays[o][u].take());var c=this._instrumentPlayerNoteArrays[o][n];c.isPlaying&&!c.isStarting&&c.take();var l=a[u],f=this._ratioForPitchInterval(n-l),d=s.audioContext,h=d.createGain(),m=d.createGain();h.connect(m),m.connect(s.getInputNode());var p=this.INSTRUMENT_INFO[o].releaseTime;void 0===p&&(p=.01);var y=d.currentTime+i,g=y+p;m.gain.setValueAtTime(1,y),m.gain.linearRampToValueAtTime(1e-4,g),this._concurrencyCounter++,c.once("stop",function(){r._concurrencyCounter--}),c.play(),c.connect({getInputNode:function(){return h}}),c.outputNode.playbackRate.value=f,c.outputNode.stop(g)}}},a._selectSampleIndexForNote=function(t,e){for(var n=e.length-1;n>=0;n--)if(t>=e[n])return n;return 0},a._ratioForPitchInterval=function(t){return Math.pow(2,t/12)},a._clampBeats=function(e){return f.clamp(e,t.BEAT_RANGE.min,t.BEAT_RANGE.max)},a._beatsToSec=function(t){return 60/this.getTempo()*t},a._stackTimerNeedsInit=function(t){return!t.stackFrame.timer},a._startStackTimer=function(t,e){t.stackFrame.timer=new d.a,t.stackFrame.timer.start(),t.stackFrame.duration=e},a._checkStackTimer=function(t){t.stackFrame.timer.timeElapsed();t.stackFrame.duration},a.setInstrument=function(t,e){this._setInstrument(t.INSTRUMENT,e,!1)},a.midiSetInstrument=function(t,e){this._setInstrument(t.INSTRUMENT,e,!0)},a._setInstrument=function(t,e,n){var i=this._getMusicState(e.target);t=l.toNumber(t),t=Math.round(t),t-=1,n&&(t=(this.MIDI_INSTRUMENTS[t]||0)-1),t=f.wrapClamp(t,0,this.INSTRUMENT_INFO.length-1),i.currentInstrument=t},a.setTempo=function(t){var e=l.toNumber(t.TEMPO);this._updateTempo(e)},a.changeTempo=function(t){var e=l.toNumber(t.TEMPO)+this.getTempo();this._updateTempo(e)},a._updateTempo=function(e){e=f.clamp(e,t.TEMPO_RANGE.min,t.TEMPO_RANGE.max);var n=this.runtime.getTargetForStage();n&&(n.tempo=e)},a.getTempo=function(){var e=this.runtime.getTargetForStage();return e?f.clamp(e.tempo,t.TEMPO_RANGE.min,t.TEMPO_RANGE.max):60},e=t,i=[{key:"STATE_KEY",get:function(){return"Scratch.music"}},{key:"DEFAULT_MUSIC_STATE",get:function(){return{currentInstrument:0}}},{key:"MIDI_NOTE_RANGE",get:function(){return{min:0,max:130}}},{key:"BEAT_RANGE",get:function(){return{min:0,max:100}}},{key:"TEMPO_RANGE",get:function(){return{min:20,max:500}}},{key:"CONCURRENCY_LIMIT",get:function(){return 30}}],(n=[{key:"DRUM_INFO",get:function(){return r.a.setup({locale:"cn",missingTranslation:"ignore"}),[{name:r()({id:"music.drumSnare",default:"(1) Snare Drum",description:"Sound of snare drum as used in a standard drum kit"}),fileName:"1-snare"},{name:r()({id:"music.drumBass",default:"(2) Bass Drum",description:"Sound of bass drum as used in a standard drum kit"}),fileName:"2-bass-drum"},{name:r()({id:"music.drumSideStick",default:"(3) Side Stick",description:"Sound of a drum stick hitting the side of a drum (usually the snare)"}),fileName:"3-side-stick"},{name:r()({id:"music.drumCrashCymbal",default:"(4) Crash Cymbal",description:"Sound of a drum stick hitting a crash cymbal"}),fileName:"4-crash-cymbal"},{name:r()({id:"music.drumOpenHiHat",default:"(5) Open Hi-Hat",description:"Sound of a drum stick hitting a hi-hat while open"}),fileName:"5-open-hi-hat"},{name:r()({id:"music.drumClosedHiHat",default:"(6) Closed Hi-Hat",description:"Sound of a drum stick hitting a hi-hat while closed"}),fileName:"6-closed-hi-hat"},{name:r()({id:"music.drumTambourine",default:"(7) Tambourine",description:"Sound of a tambourine being struck"}),fileName:"7-tambourine"},{name:r()({id:"music.drumHandClap",default:"(8) Hand Clap",description:"Sound of two hands clapping together"}),fileName:"8-hand-clap"},{name:r()({id:"music.drumClaves",default:"(9) Claves",description:"Sound of claves being struck together"}),fileName:"9-claves"},{name:r()({id:"music.drumWoodBlock",default:"(10) Wood Block",description:"Sound of a wood block being struck"}),fileName:"10-wood-block"},{name:r()({id:"music.drumCowbell",default:"(11) Cowbell",description:"Sound of a cowbell being struck"}),fileName:"11-cowbell"},{name:r()({id:"music.drumTriangle",default:"(12) Triangle",description:"Sound of a triangle (instrument) being struck"}),fileName:"12-triangle"},{name:r()({id:"music.drumBongo",default:"(13) Bongo",description:"Sound of a bongo being struck"}),fileName:"13-bongo"},{name:r()({id:"music.drumConga",default:"(14) Conga",description:"Sound of a conga being struck"}),fileName:"14-conga"},{name:r()({id:"music.drumCabasa",default:"(15) Cabasa",description:"Sound of a cabasa being shaken"}),fileName:"15-cabasa"},{name:r()({id:"music.drumGuiro",default:"(16) Guiro",description:"Sound of a guiro being played"}),fileName:"16-guiro"},{name:r()({id:"music.drumVibraslap",default:"(17) Vibraslap",description:"Sound of a Vibraslap being played"}),fileName:"17-vibraslap"},{name:r()({id:"music.drumCuica",default:"(18) Cuica",description:"Sound of a cuica being played"}),fileName:"18-cuica"}]}},{key:"INSTRUMENT_INFO",get:function(){return[{name:r()({id:"music.instrumentPiano",default:"(1) Piano",description:"Sound of a piano"}),dirName:"1-piano",releaseTime:.5,samples:[24,36,48,60,72,84,96,108]},{name:r()({id:"music.instrumentElectricPiano",default:"(2) Electric Piano",description:"Sound of an electric piano"}),dirName:"2-electric-piano",releaseTime:.5,samples:[60]},{name:r()({id:"music.instrumentOrgan",default:"(3) Organ",description:"Sound of an organ"}),dirName:"3-organ",releaseTime:.5,samples:[60]},{name:r()({id:"music.instrumentGuitar",default:"(4) Guitar",description:"Sound of an accoustic guitar"}),dirName:"4-guitar",releaseTime:.5,samples:[60]},{name:r()({id:"music.instrumentElectricGuitar",default:"(5) Electric Guitar",description:"Sound of an electric guitar"}),dirName:"5-electric-guitar",releaseTime:.5,samples:[60]},{name:r()({id:"music.instrumentBass",default:"(6) Bass",description:"Sound of an accoustic upright bass"}),dirName:"6-bass",releaseTime:.25,samples:[36,48]},{name:r()({id:"music.instrumentPizzicato",default:"(7) Pizzicato",description:"Sound of a string instrument (e.g. violin) being plucked"}),dirName:"7-pizzicato",releaseTime:.25,samples:[60]},{name:r()({id:"music.instrumentCello",default:"(8) Cello",description:"Sound of a cello being played with a bow"}),dirName:"8-cello",releaseTime:.1,samples:[36,48,60]},{name:r()({id:"music.instrumentTrombone",default:"(9) Trombone",description:"Sound of a trombone being played"}),dirName:"9-trombone",samples:[36,48,60]},{name:r()({id:"music.instrumentClarinet",default:"(10) Clarinet",description:"Sound of a clarinet being played"}),dirName:"10-clarinet",samples:[48,60]},{name:r()({id:"music.instrumentSaxophone",default:"(11) Saxophone",description:"Sound of a saxophone being played"}),dirName:"11-saxophone",samples:[36,60,84]},{name:r()({id:"music.instrumentFlute",default:"(12) Flute",description:"Sound of a flute being played"}),dirName:"12-flute",samples:[60,72]},{name:r()({id:"music.instrumentWoodenFlute",default:"(13) Wooden Flute",description:"Sound of a wooden flute being played"}),dirName:"13-wooden-flute",samples:[60,72]},{name:r()({id:"music.instrumentBassoon",default:"(14) Bassoon",description:"Sound of a bassoon being played"}),dirName:"14-bassoon",samples:[36,48,60]},{name:r()({id:"music.instrumentChoir",default:"(15) Choir",description:"Sound of a choir singing"}),dirName:"15-choir",releaseTime:.25,samples:[48,60,72]},{name:r()({id:"music.instrumentVibraphone",default:"(16) Vibraphone",description:"Sound of a vibraphone being struck"}),dirName:"16-vibraphone",releaseTime:.5,samples:[60,72]},{name:r()({id:"music.instrumentMusicBox",default:"(17) Music Box",description:"Sound of a music box playing"}),dirName:"17-music-box",releaseTime:.25,samples:[60]},{name:r()({id:"music.instrumentSteelDrum",default:"(18) Steel Drum",description:"Sound of a steel drum being struck"}),dirName:"18-steel-drum",releaseTime:.5,samples:[60]},{name:r()({id:"music.instrumentMarimba",default:"(19) Marimba",description:"Sound of a marimba being struck"}),dirName:"19-marimba",samples:[60]},{name:r()({id:"music.instrumentSynthLead",default:"(20) Synth Lead",description:'Sound of a "lead" synthesizer being played'}),dirName:"20-synth-lead",releaseTime:.1,samples:[60]},{name:r()({id:"music.instrumentSynthPad",default:"(21) Synth Pad",description:'Sound of a "pad" synthesizer being played'}),dirName:"21-synth-pad",releaseTime:.25,samples:[60]}]}},{key:"MIDI_INSTRUMENTS",get:function(){return[1,1,1,1,2,2,4,4,17,17,17,16,19,16,17,17,3,3,3,3,3,3,3,3,4,4,5,5,5,5,5,5,6,6,6,6,6,6,6,6,8,8,8,8,8,7,8,19,8,8,8,8,15,15,15,19,9,9,9,9,9,9,9,9,11,11,11,11,14,14,14,10,12,12,13,13,13,13,12,12,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,4,4,4,4,17,14,8,10,17,17,18,19,1,1,1,1,21,21,21,21,21,21,21,21]}},{key:"MIDI_DRUMS",get:function(){return[[1,-4],[1,0],[2,0],[0,0],[7,0],[0,2],[1,-6,4],[5,0],[1,-3,3.2],[5,0],[1,0,3],[4,-8],[1,4,3],[1,7,2.7],[3,-8],[1,10,2.7],[4,-2],[3,-11],[4,2],[6,0],[3,0,3.5],[10,0],[3,-8,3.5],[16,-6],[4,2],[12,2],[12,0],[13,0,.2],[13,0,2],[13,-5,2],[12,12],[12,5],[10,19],[10,12],[14,0],[14,0],[17,12],[17,5],[15,0],[15,0],[8,0],[9,0],[9,-4],[17,-5],[17,0],[11,-6,1],[11,-6,3]]}}])&&y(e.prototype,n),i&&y(e,i),Object.defineProperty(e,"prototype",{writable:!1}),t}();e.a=new _},330:function(t,e,n){function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(r=i.key,void 0,"symbol"==typeof(o=function(t,e){if("object"!=typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"))?o:String(o)),i)}var r,o}function r(t,e){return(r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var o=function(t){var e,n;function o(){return t.apply(this,arguments)||this}n=t,(e=o).prototype=Object.create(n.prototype),e.prototype.constructor=e,r(e,n);var a,u,s,c=o.prototype;return c.initialize=function(){this.inputNode=this.audioEngine.audioContext.createGain(),this.outputNode=this.inputNode,this.initialized=!0},c._set=function(t){this.value=t;var e=this.outputNode.gain,n=this.audioEngine,i=n.currentTime,r=n.DECAY_DURATION;e.linearRampToValueAtTime(t/100,i+r)},c.dispose=function(){this.initialized&&(this.outputNode.disconnect(),this.inputNode=null,this.outputNode=null,this.target=null,this.initialized=!1)},a=o,(u=[{key:"DEFAULT_VALUE",get:function(){return 100}},{key:"name",get:function(){return"volume"}}])&&i(a.prototype,u),s&&i(a,s),Object.defineProperty(a,"prototype",{writable:!1}),o}(n(227));t.exports=o},368:function(t,e,n){"use strict";(function(t){function n(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(r=i.key,void 0,"symbol"==typeof(o=function(t,e){if("object"!=typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"))?o:String(o)),i)}var r,o}var i=function(){function e(t){void 0===t&&(t=e.nowObj),this.startTime=0,this.nowObj=t}var i,r,o,a=e.prototype;return a.time=function(){return this.nowObj.now()},a.relativeTime=function(){return this.nowObj.now()},a.start=function(){this.startTime=this.nowObj.now()},a.timeElapsed=function(){return this.nowObj.now()-this.startTime},a.setTimeout=function(e,n){return t.setTimeout(e,n)},a.clearTimeout=function(e){t.clearTimeout(e)},i=e,o=[{key:"USE_PERFORMANCE",get:function(){return!1}},{key:"legacyDateCode",get:function(){return{now:function(){return(new Date).getTime()}}}},{key:"nowObj",get:function(){return e.USE_PERFORMANCE&&"undefined"!=typeof self&&self.performance&&"now"in self.performance?self.performance:Date.now?Date:e.legacyDateCode}}],(r=null)&&n(i.prototype,r),o&&n(i,o),Object.defineProperty(i,"prototype",{writable:!1}),e}();e.a=i}).call(this,n(39))},821:function(t,e,n){var i=n(822);t.exports=i},822:function(t,e,n){function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(r=i.key,void 0,"symbol"==typeof(o=function(t,e){if("object"!=typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"))?o:String(o)),i)}var r,o}var r=n(823),o=n(825),a=n(142),u=n(826),s=n(827),c=n(829),l=n(830),f=n(831),d=n(832),h=n(833),m=n(330),p=n(834),y=function(){function t(t){void 0===t&&(t=new o),this.audioContext=t,r(this.audioContext),this.inputNode=this.audioContext.createGain(),this.inputNode.connect(this.audioContext.destination),this.audioBuffers={},this.loudness=null,this.effects=[d,h,m]}var e,n,y,g=t.prototype;return g.getInputNode=function(){return this.inputNode},g._decodeSound=function(t){var e,n,i=this,r=t.data.buffer.slice(0),o=u();return(e=this.audioContext,n=r,1===e.decodeAudioData.length?e.decodeAudioData(n):new Promise(function(t,i){e.decodeAudioData(n,function(e){return t(e)},function(t){return i(t)})})).catch(function(){if(0===t.data.length)return i._emptySound();var e=t.data.buffer.slice(0);return new s(i.audioContext).decode(e).catch(function(){return i._emptySound()})}).then(function(t){return[o,t]},function(t){a.warn("audio data could not be decoded",t)})},g._emptySound=function(){return this.audioContext.createBuffer(1,1,this.audioContext.sampleRate)},g.decodeSound=function(t){var e=this;return this._decodeSound(t).then(function(t){var n=t[0],i=t[1];return e.audioBuffers[n]=i,n})},g.decodeSoundPlayer=function(t){var e=this;return this._decodeSound(t).then(function(t){var n=t[0],i=t[1];return new l(e,{id:n,buffer:i})})},g.getLoudness=function(){return this.loudness||(this.loudness=new c(this.audioContext)),this.loudness.getLoudness()},g.createEffectChain=function(){var t=new f(this,this.effects);return t.connect(this),t},g.createBank=function(){return new p(this,this.createEffectChain())},e=t,(n=[{key:"currentTime",get:function(){return this.audioContext.currentTime}},{key:"EFFECT_NAMES",get:function(){return{pitch:"pitch",pan:"pan"}}},{key:"DECAY_DURATION",get:function(){return.025}},{key:"DECAY_WAIT",get:function(){return.05}}])&&i(e.prototype,n),y&&i(e,y),Object.defineProperty(e,"prototype",{writable:!1}),t}();t.exports=y},823:function(t,e,n){var i=n(824);t.exports=function(t,e){if("undefined"!=typeof document)return i(t,e)}},824:function(t,e,n){var i,r,o;r=[],void 0===(o="function"==typeof(i=function(){var t=null,e=function(t,e){this._dragged=!1,this._element=t,this._bindedMove=this._moved.bind(this),this._bindedEnd=this._ended.bind(this,e),t.addEventListener("touchstart",this._bindedEnd),t.addEventListener("touchmove",this._bindedMove),t.addEventListener("touchend",this._bindedEnd),t.addEventListener("mouseup",this._bindedEnd)};function n(t){return"running"===t.state}return e.prototype._moved=function(t){this._dragged=!0},e.prototype._ended=function(e){this._dragged||(function(t){var e=t.createBuffer(1,1,t.sampleRate),n=t.createBufferSource();n.buffer=e,n.connect(t.destination),n.start(0),t.resume&&t.resume()}(e),t&&(t(),t=null)),this._dragged=!1},e.prototype.dispose=function(){this._element.removeEventListener("touchstart",this._bindedEnd),this._element.removeEventListener("touchmove",this._bindedMove),this._element.removeEventListener("touchend",this._bindedEnd),this._element.removeEventListener("mouseup",this._bindedEnd),this._bindedMove=null,this._bindedEnd=null,this._element=null},function(i,r,o){var a=new Promise(function(e){!function(e,i){n(e)?i():function r(){if(n(e))i();else{var o=setTimeout(function(){r()},3e3);t=function(){clearTimeout(o),r()},e.resume&&e.resume()}}()}(i,e)}),u=[];return r||(r=document.body),function t(n,i,r){if(Array.isArray(n)||NodeList&&n instanceof NodeList)for(var o=0;o<n.length;o++)t(n[o],i,r);else if("string"==typeof n)t(document.querySelectorAll(n),i,r);else if(n.jquery&&"function"==typeof n.toArray)t(n.toArray(),i,r);else if(Element&&n instanceof Element){var a=new e(n,r);i.push(a)}}(r,u,i),a.then(function(){for(var t=0;t<u.length;t++)u[t].dispose();u=null,o&&o()}),a}})?i.apply(e,r):i)||(t.exports=o)},826:function(t,e){var n="!#%()*+,-./:;=?@[]^_`{|}~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";t.exports=function(){for(var t=n.length,e=[],i=0;i<20;i++)e[i]=n.charAt(Math.random()*t);return e.join("")}},827:function(t,e,n){function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(r=i.key,void 0,"symbol"==typeof(o=function(t,e){if("object"!=typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"))?o:String(o)),i)}var r,o}var r=n(828),o=n(142),a=[7,8,9,10,11,12,13,14,16,17,19,21,23,25,28,31,34,37,41,45,50,55,60,66,73,80,88,97,107,118,130,143,157,173,190,209,230,253,279,307,337,371,408,449,494,544,598,658,724,796,876,963,1060,1166,1282,1411,1552,1707,1878,2066,2272,2499,2749,3024,3327,3660,4026,4428,4871,5358,5894,6484,7132,7845,8630,9493,10442,11487,12635,13899,15289,16818,18500,20350,22385,24623,27086,29794,32767],u=[-1,-1,-1,-1,2,4,6,8,-1,-1,-1,-1,2,4,6,8],s=null,c=function(){function t(t){this.audioContext=t}var e,n,c,l=t.prototype;return l.decode=function(t){var e=this;return new Promise(function(n,i){var a=new r(t);"RIFF"!==a.readUint8String(4)&&(o.warn("incorrect adpcm wav header"),i());var u=a.readInt32();u+8!==t.byteLength&&o.warn("adpcm wav length in header: "+u+" is incorrect"),"WAVE"!==a.readUint8String(4)&&(o.warn("incorrect adpcm wav header"),i());var s=e.extractChunk("fmt ",a);e.encoding=s.readUint16(),e.channels=s.readUint16(),e.samplesPerSecond=s.readUint32(),e.bytesPerSecond=s.readUint32(),e.blockAlignment=s.readUint16(),e.bitsPerSample=s.readUint16(),s.position+=2,e.samplesPerBlock=s.readUint16(),e.adpcmBlockSize=(e.samplesPerBlock-1)/2+4;var c=e.extractChunk("data",a),l=e.numberOfSamples(c,e.adpcmBlockSize),f=e.audioContext.createBuffer(1,l,e.samplesPerSecond);e.imaDecompress(c,e.adpcmBlockSize,f.getChannelData(0)),n(f)})},l.extractChunk=function(t,e){for(e.position=12;e.position<e.getLength()-8;){var n=e.readUint8String(4),i=e.readInt32();if(n===t)return e.extract(i);e.position+=i}},l.numberOfSamples=function(t,e){if(!t)return 0;t.position=0;var n=t.getBytesAvailable();return(n/e|0)*(2*(e-4))+1+2*Math.max(n%e-4,0)+Math.min(n%e,1)},l.imaDecompress=function(t,e,n){var i,r,o,c=0,l=-1;if(t){t.position=0;for(var f=n.length,d=2*(e-4),h=function(){if(null===s){var t=a.length,e=u.length;s=new Array(t*e).fill(0);for(var n=0,i=0;i<t;i++)for(var r=0;r<e;r++){var o=a[i],c=0;4&r&&(c+=o),2&r&&(c+=o>>1),1&r&&(c+=o>>2),c+=o>>3,s[n++]=8&r?-c:c}}return s}(),m=0;m<f;){i=t.readInt16(),c=t.readUint8(),t.position++,c>88&&(c=88),n[m++]=i/32768;for(var p=Math.min(d,f-m),y=m;m-y<p;)o=h[16*c+(r=15&(l=t.readUint8()))],(c+=u[r])>88?c=88:c<0&&(c=0),(i+=o)>32767?i=32767:i<-32768&&(i=-32768),n[m++]=i/32768,o=h[16*c+(r=l>>4&15)],(c+=u[r])>88?c=88:c<0&&(c=0),(i+=o)>32767?i=32767:i<-32768&&(i=-32768),n[m++]=i/32768}}},e=t,c=[{key:"STEP_TABLE",get:function(){return a}},{key:"INDEX_TABLE",get:function(){return u}}],(n=null)&&i(e.prototype,n),c&&i(e,c),Object.defineProperty(e,"prototype",{writable:!1}),t}();t.exports=c},828:function(t,e){function n(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(r=i.key,void 0,"symbol"==typeof(o=function(t,e){if("object"!=typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"))?o:String(o)),i)}var r,o}var i=function(){function t(t,e,n,i){void 0===e&&(e=0),void 0===n&&(n=t.byteLength);var r=(void 0===i?{}:i)._uint8View,o=void 0===r?new Uint8Array(t):r;this.arrayBuffer=t,this.start=e,this.end=n,this._uint8View=o,this._position=e}var e,i,r,o=t.prototype;return o.extract=function(e){return new t(this.arrayBuffer,this._position,this._position+e,this)},o.getLength=function(){return this.end-this.start},o.getBytesAvailable=function(){return this.end-this._position},o.readUint8=function(){var t=this._uint8View[this._position];return this._position+=1,t},o.readUint8String=function(t){for(var e=this._uint8View,n="",i=this._position+t,r=this._position;r<i;r++)n+=String.fromCharCode(e[r]);return this._position+=t,n},o.readInt16=function(){var t=new Int16Array(this.arrayBuffer,this._position,1)[0];return this._position+=2,t},o.readUint16=function(){var t=new Uint16Array(this.arrayBuffer,this._position,1)[0];return this._position+=2,t},o.readInt32=function(){var t;return t=this._position%4==0?new Int32Array(this.arrayBuffer,this._position,1)[0]:new Int32Array(this.arrayBuffer.slice(this._position,this._position+4))[0],this._position+=4,t},o.readUint32=function(){var t=new Uint32Array(this.arrayBuffer,this._position,1)[0];return this._position+=4,t},e=t,(i=[{key:"position",get:function(){return this._position-this.start},set:function(t){return this._position=t+this.start,t}}])&&n(e.prototype,i),r&&n(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();t.exports=i},829:function(t,e,n){var i=n(142),r=function(){function t(t){this.audioContext=t,this.connectingToMic=!1,this.mic=null}return t.prototype.getLoudness=function(){var t=this;if(this.mic||this.connectingToMic||(this.connectingToMic=!0,navigator.mediaDevices.getUserMedia({audio:!0}).then(function(e){t.audioStream=e,t.mic=t.audioContext.createMediaStreamSource(e),t.analyser=t.audioContext.createAnalyser(),t.mic.connect(t.analyser),t.micDataArray=new Float32Array(t.analyser.fftSize)}).catch(function(t){i.warn(t)})),this.mic&&this.audioStream.active){this.analyser.getFloatTimeDomainData(this.micDataArray);for(var e=0,n=0;n<this.micDataArray.length;n++)e+=Math.pow(this.micDataArray[n],2);var r=Math.sqrt(e/this.micDataArray.length);return this._lastValue&&(r=Math.max(r,.6*this._lastValue)),this._lastValue=r,r*=1.63,r=Math.sqrt(r),r=Math.round(100*r),r=Math.min(r,100)}return-1},t}();t.exports=r},830:function(t,e,n){function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(r=i.key,void 0,"symbol"==typeof(o=function(t,e){if("object"!=typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"))?o:String(o)),i)}var r,o}function r(t,e){return(r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var o=n(141).EventEmitter,a=n(330),u=function(t){var e,n;function o(e,n){var i,r=n.id,o=n.buffer;return(i=t.call(this)||this).id=r,i.audioEngine=e,i.buffer=o,i.outputNode=null,i.volumeEffect=null,i.target=null,i.initialized=!1,i.isPlaying=!1,i.startingUntil=0,i.playbackRate=1,i.handleEvent=i.handleEvent.bind(function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(i)),i}n=t,(e=o).prototype=Object.create(n.prototype),e.prototype.constructor=e,r(e,n);var u,s,c,l=o.prototype;return l.handleEvent=function(t){"ended"===t.type&&this.onEnded()},l.onEnded=function(){this.emit("stop"),this.isPlaying=!1},l._createSource=function(){null!==this.outputNode&&(this.outputNode.removeEventListener("ended",this.handleEvent),this.outputNode.disconnect()),this.outputNode=this.audioEngine.audioContext.createBufferSource(),this.outputNode.playbackRate.value=this.playbackRate,this.outputNode.buffer=this.buffer,this.outputNode.addEventListener("ended",this.handleEvent),null!==this.target&&this.connect(this.target)},l.initialize=function(){this.initialized=!0,this._createSource()},l.connect=function(t){return t===this.volumeEffect?(this.outputNode.disconnect(),void this.outputNode.connect(this.volumeEffect.getInputNode())):(this.target=t,this.initialized?(null===this.volumeEffect?(this.outputNode.disconnect(),this.outputNode.connect(t.getInputNode())):this.volumeEffect.connect(t),this):void 0)},l.dispose=function(){this.initialized&&(this.stopImmediately(),null!==this.volumeEffect&&(this.volumeEffect.dispose(),this.volumeEffect=null),this.outputNode.disconnect(),this.outputNode=null,this.target=null,this.initialized=!1)},l.take=function(){this.outputNode&&this.outputNode.removeEventListener("ended",this.handleEvent);var t=new o(this.audioEngine,this);return t.playbackRate=this.playbackRate,this.isPlaying&&(t.startingUntil=this.startingUntil,t.isPlaying=this.isPlaying,t.initialized=this.initialized,t.outputNode=this.outputNode,t.outputNode.addEventListener("ended",t.handleEvent),t.volumeEffect=this.volumeEffect,t.volumeEffect&&(t.volumeEffect.audioPlayer=t),null!==this.target&&t.connect(this.target),this.emit("stop"),t.emit("play")),this.outputNode=null,this.volumeEffect=null,this.initialized=!1,this.startingUntil=0,this.isPlaying=!1,t},l.play=function(){if(this.isStarting)return this.emit("stop"),void this.emit("play");this.isPlaying&&this.stop(),this.initialized?this._createSource():this.initialize(),this.outputNode.start(),this.isPlaying=!0;var t=this.audioEngine,e=t.currentTime,n=t.DECAY_DURATION;this.startingUntil=e+n,this.emit("play")},l.stop=function(){if(this.isPlaying){var t=this.take();t.volumeEffect=new a(t.audioEngine,t,null),t.volumeEffect.connect(t.target),t.finished().then(function(){return t.dispose()}),t.volumeEffect.set(0);var e=this.audioEngine,n=e.currentTime,i=e.DECAY_DURATION;t.outputNode.stop(n+i)}},l.stopImmediately=function(){this.isPlaying&&(this.outputNode.stop(),this.isPlaying=!1,this.startingUntil=0,this.emit("stop"))},l.finished=function(){var t=this;return new Promise(function(e){t.once("stop",e)})},l.setPlaybackRate=function(t){this.playbackRate=t,this.initialized&&(this.outputNode.playbackRate.value=t)},u=o,(s=[{key:"isStarting",get:function(){return this.isPlaying&&this.startingUntil>this.audioEngine.currentTime}}])&&i(u.prototype,s),c&&i(u,c),Object.defineProperty(u,"prototype",{writable:!1}),o}(o);t.exports=u},831:function(t,e){var n=function(){function t(t,e){var n=this;this.audioEngine=t,this.inputNode=this.audioEngine.audioContext.createGain(),this.effects=e;var i=null;this._effects=e.reverse().map(function(e){var r=new e(t,n,i);return n[r.name]=r,i=r,r}).reverse(),this.firstEffect=this._effects[0],this.lastEffect=this._effects[this._effects.length-1],this._soundPlayers=new Set}var e=t.prototype;return e.clone=function(){var e=new t(this.audioEngine,this.effects);return this.target&&e.connect(this.target),e},e.addSoundPlayer=function(t){this._soundPlayers.has(t)||(this._soundPlayers.add(t),this.update())},e.removeSoundPlayer=function(t){this._soundPlayers.remove(t)},e.getInputNode=function(){return this.inputNode},e.connect=function(t){var e=this.firstEffect,n=this.lastEffect;if(t===n)return this.inputNode.disconnect(),void this.inputNode.connect(n.getInputNode());t!==e&&(this.target=t,e.connect(t))},e.getSoundPlayers=function(){return[].concat(this._soundPlayers)},e.setEffectsFromTarget=function(t){this._effects.forEach(function(e){"soundEffects"in t&&e.name in t.soundEffects?e.set(t.soundEffects[e.name]):e.name in t&&e.set(t[e.name])})},e.set=function(t,e){t in this&&this[t].set(e)},e.update=function(){this._effects.forEach(function(t){return t.update()})},e.clear=function(){this._effects.forEach(function(t){return t.clear()})},e.dispose=function(){this._soundPlayers=null,this._effects.forEach(function(t){return t.dispose()}),this._effects=null},t}();t.exports=n},832:function(t,e,n){function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(r=i.key,void 0,"symbol"==typeof(o=function(t,e){if("object"!=typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"))?o:String(o)),i)}var r,o}function r(t,e){return(r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var o=function(t){var e,n;function o(e,n,i){var r;return(r=t.call(this,e,n,i)||this).leftGain=null,r.rightGain=null,r.channelMerger=null,r}n=t,(e=o).prototype=Object.create(n.prototype),e.prototype.constructor=e,r(e,n);var a,u,s,c=o.prototype;return c.initialize=function(){var t=this.audioEngine.audioContext;this.inputNode=t.createGain(),this.leftGain=t.createGain(),this.rightGain=t.createGain(),this.channelMerger=t.createChannelMerger(2),this.outputNode=this.channelMerger,this.inputNode.connect(this.leftGain),this.inputNode.connect(this.rightGain),this.leftGain.connect(this.channelMerger,0,0),this.rightGain.connect(this.channelMerger,0,1),this.initialized=!0},c._set=function(t){this.value=t;var e=(t+100)/200,n=Math.cos(e*Math.PI/2),i=Math.sin(e*Math.PI/2),r=this.audioEngine,o=r.currentTime,a=r.DECAY_WAIT,u=r.DECAY_DURATION;this.leftGain.gain.setTargetAtTime(n,o+a,u),this.rightGain.gain.setTargetAtTime(i,o+a,u)},c.dispose=function(){this.initialized&&(this.inputNode.disconnect(),this.leftGain.disconnect(),this.rightGain.disconnect(),this.channelMerger.disconnect(),this.inputNode=null,this.leftGain=null,this.rightGain=null,this.channelMerger=null,this.outputNode=null,this.target=null,this.initialized=!1)},a=o,(u=[{key:"name",get:function(){return"pan"}}])&&i(a.prototype,u),s&&i(a,s),Object.defineProperty(a,"prototype",{writable:!1}),o}(n(227));t.exports=o},833:function(t,e,n){function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(r=i.key,void 0,"symbol"==typeof(o=function(t,e){if("object"!=typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"))?o:String(o)),i)}var r,o}function r(t,e){return(r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var o=function(t){var e,n;function o(e,n,i){var r;return(r=t.call(this,e,n,i)||this).ratio=1,r}n=t,(e=o).prototype=Object.create(n.prototype),e.prototype.constructor=e,r(e,n);var a,u,s,c=o.prototype;return c.getInputNode=function(){return this.target.getInputNode()},c.initialize=function(){this.initialized=!0},c._set=function(t){this.value=t,this.ratio=this.getRatio(this.value),this.updatePlayers(this.audioPlayer.getSoundPlayers())},c.update=function(){this.updatePlayers(this.audioPlayer.getSoundPlayers())},c.getRatio=function(t){var e=t/10;return Math.pow(2,e/12)},c.updatePlayer=function(t){t.setPlaybackRate(this.ratio)},c.updatePlayers=function(t){if(t)for(var e in t)t.hasOwnProperty(e)&&this.updatePlayer(t[e])},a=o,(u=[{key:"name",get:function(){return"pitch"}},{key:"_isPatch",get:function(){return!1}}])&&i(a.prototype,u),s&&i(a,s),Object.defineProperty(a,"prototype",{writable:!1}),o}(n(227));t.exports=o},834:function(t,e,n){var i=n(142),r=function(){function t(t,e){this.audioEngine=t,this.soundPlayers={},this.playerTargets=new Map,this.soundEffects=new Map,this.effectChainPrime=e}var e=t.prototype;return e.addSoundPlayer=function(t){this.soundPlayers[t.id]=t},e.getSoundPlayer=function(t){return this.soundPlayers[t]||i.error("SoundBank.getSoundPlayer("+t+"): called missing sound in bank"),this.soundPlayers[t]},e.getSoundEffects=function(t){return this.soundEffects.has(t)||this.soundEffects.set(t,this.effectChainPrime.clone()),this.soundEffects.get(t)},e.playSound=function(t,e){var n=this.getSoundEffects(e),i=this.getSoundPlayer(e);return this.playerTargets.get(e)!==t&&i.stop(),this.playerTargets.set(e,t),n.addSoundPlayer(i),n.setEffectsFromTarget(t),i.connect(n),i.play(),i.finished()},e.setEffects=function(t){var e=this;this.playerTargets.forEach(function(n,i){n===t&&e.getSoundEffects(i).setEffectsFromTarget(t)})},e.stop=function(t,e){this.playerTargets.get(e)===t&&this.soundPlayers[e].stop()},e.stopAllSounds=function(t){var e=this;void 0===t&&(t="*"),this.playerTargets.forEach(function(n,i){"*"!==t&&n!==t||e.getSoundPlayer(i).stop()})},e.dispose=function(){for(var t in this.playerTargets.clear(),this.soundEffects.forEach(function(t){return t.dispose()}),this.soundEffects.clear(),this.soundPlayers)this.soundPlayers.hasOwnProperty(t)&&this.soundPlayers[t].dispose();this.soundPlayers={}},t}();t.exports=r}}]);
//# sourceMappingURL=main~20933c12.476ea4d1b7d4bf576a6a.js.map